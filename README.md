# Домашнее задание к занятию "`Система мониторинга Zabbix`" - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---

### Задание 1

`Приведите ответ в свободной форме........`

1. `Обновляем КЭШ репозиториев и обновляем зависимости`
2. `Устанавливаем posttgres`
3. `Скачиваем репу`
4. `Ставим репозитории и опять обновляем кэш репозиториев что бы появились репозитория zabbix`
5. `Создаем юзера для БД и создаем саму БД`
6. `Копируем задержимое в БД`
7. `Прописываем юзера БД и пароль в настройках zabbix сервера` 
8. `Рестартуем, включаем, проверяем что apache и zabbix server запустились`

```
sudo apt update
sudo apt upgrade
sudo apt install postgresql postgresql-contrib

wget https://repo.zabbix.com/zabbix/6.0/debian/pool/main/z/zabbix-release/zabbix-release_6.0-4+debian11_all.deb
dpkg -i zabbix-release_6.0-4+debian11_all.deb
apt update
su - postgres -c 'psql --command "CREATE USER zabbix WITH PASSWORD '\'123456789\'';"' 

su - postgres -c 'psql --command "CREATE DATABASE zabbix OWNER zabbix;"' 

zcat /usr/share/zabbix-sql-scripts/postgresql/server.sql.gz | sudo -u zabbix psql zabbix
sed -i 's/# DBPassword=/DBPassword=123456789/g' /etc/zabbix/zabbix_server.conf 

systemctl restart zabbix-server  apache2

systemctl enable zabbix-server apache2

systemctl status zabbix-server  apache2

```

При необходимости прикрепитe сюда скриншоты
[Окно Авторизации](https://ru.paste.pics/1dda3d290162d2c82283ae29b459aa67)


---

### Задание 2

`Приведите ответ в свободной форме........`

1. `Заходим на WEB -> Configuration->Hosts->Create hos`
2. `Далее прописываем имя хоста, добавляем группы(может сделать свои), добавляем интерфейс и настраиваем подключение по IP или DNS(на ваш выбор если есть DNS у сервера)`
3. `Добавляем и когда Status будет Enabled, а Availability гореть зеленом`
4. `И конечно что бы все получилось нужно в самом агенте прописать IP(нашего сервреа) или повесть, к кому он может подключаться`
5. `В данный момент я подключил два агента, один стоит на отдельной машине второй на самом сервере`
6. 

```
wget https://repo.zabbix.com/zabbix/6.0/debian/pool/main/z/zabbix-release/zabbix-release_6.0-4+debian11_all.deb

dpkg -i zabbix-release_6.0-4+debian11_all.deb

apt update apt install zabbix-agent

systemctl restart zabbix-agent

systemctl enable zabbix-agent

systemctl status zabbix-agent
```

При необходимости прикрепитe сюда скриншоты
[Скриншот что zabbix агенты подключены](https://ru.paste.pics/87ceb3b9b1ae787b746b2655d5e62b37)
[Скриншот что все работает как нужно](https://ru.paste.pics/83d123bfb565c98f53fb191560e48473)
[Скриншот Monitoring->Latest Data](https://ru.paste.pics/c5149a9fbf9e06c8d82f439b0e940ac1)


---

### Задание 3

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

```
Поле для вставки кода...
....
....
....
....
```

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`

### Задание 4

`Приведите ответ в свободной форме........`

1. `Заполните здесь этапы выполнения, если требуется ....`
2. `Заполните здесь этапы выполнения, если требуется ....`
3. `Заполните здесь этапы выполнения, если требуется ....`
4. `Заполните здесь этапы выполнения, если требуется ....`
5. `Заполните здесь этапы выполнения, если требуется ....`
6. 

```
Поле для вставки кода...
....
....
....
....
```

`При необходимости прикрепитe сюда скриншоты
![Название скриншота](ссылка на скриншот)`




# Домашнее задание к занятию "`Система мониторинга Zabbix. Часть 2`" - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---

### Задание 1

`Создайте свой шаблон, в котором будут элементы данных, мониторящие загрузку CPU и RAM хоста`

1. `Заходим в Configuration -> Templates`
2. `Нажимаем Create Templates`
3. `Указываем Template name, Groups, `
4. `Далее настроил макрос {$UPDATE_INTERVAL_TIME}`
5. `Добавил свои items в Templat,  proc.cpu.util и proc.mem`


При необходимости прикрепитe сюда скриншоты
[Скрин templates](https://ru.paste.pics/e37f4b901964110ea04b456162750112)
[Скрин items](https://ru.paste.pics/e0d190c98a9aeca2fc79e7cc15709386)


---

### Задание 2

`Добавьте в Zabbix два хоста и задайте им имена <фамилия и инициалы-1> и <фамилия и инициалы-2>. Например: ivanovii-1 и ivanovii-2`

1. `Поднял две вертуальные машине с именами iszheltov-1 и iszheltov-2`
2. `Установил на ни zabbix агентов и в конфигах прописал ip сервера (код по установке нижк)`
3. `закрепил за каждый агентов шаблон Linux by Zabbix Agent`
4. `Проверил что в разделе Latest Data начали появляться данные с добавленных агентов`

```
wget https://repo.zabbix.com/zabbix/6.0/debian/pool/main/z/zabbix-release/zabbix-release_6.0-4+debian11_all.deb

dpkg -i zabbix-release_6.0-4+debian11_all.deb

apt update 

apt install zabbix-agent

systemctl restart zabbix-agent

systemctl enable zabbix-agent

systemctl status zabbix-agent
```

При необходимости прикрепитe сюда скриншоты
[Скриншот что мой шаблон привязан к двух хостам iszheltov-1 и iszheltov-2](https://ru.paste.pics/0e05077b061cc9ea4d06e42557705e0c)
[Скрин что они активны](https://ru.paste.pics/dfb07ec642e73ebbbf67bcceb3d14a46)
[Скрин моего itema CPU](https://ru.paste.pics/bf242460629822218afe7c4343881e85)
[Скрин моего itema MEMORY](https://ru.paste.pics/ab509708575df8eb00071b9011cf6ae5)


---

### Задание 3

`Привяжите созданный шаблон к двум хостам. Также привяжите к обоим хостам шаблон Linux by Zabbix Agent`

1. `Зашле в настройки каждого хоста и в разделы Templates и прикрепил к этим хостам мой шаблон`
2. `Привязал им Linux by Zabbix Agent`
3. `Проверил что в разделе Latest Data начали появляться данные с добавленных агентов` 

[Название скриншота](ссылка на скриншот)
[Скриншот что мой шаблон привязан к двух хостам iszheltov-1 и iszheltov-2](https://ru.paste.pics/0e05077b061cc9ea4d06e42557705e0c)
[Скрин что они активны](https://ru.paste.pics/dfb07ec642e73ebbbf67bcceb3d14a46)
[Скрин моего itema CPU](https://ru.paste.pics/bf242460629822218afe7c4343881e85)
[Скрин моего itema MEMORY](https://ru.paste.pics/ab509708575df8eb00071b9011cf6ae5)


### Задание 4

`Создайте свой кастомный дашборд`

1. `Зашел и создал свой шаблон`
2. `на шаблоне расместил все свои тачки и так же разместил метрики со своими items`

При необходимости прикрепитe сюда скриншоты
[скрин дашборда](https://ru.paste.pics/32bba9f8cd4de6a9a476140c3a5b1d5a)



# Домашнее задание к занятию "`Система мониторинга Prometheus`" - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---

### Задание 1

`Установите Prometheus`


При необходимости прикрепитe сюда скриншоты
[Скрин Prometheus](https://ru.paste.pics/2e67388e4ea1aa6f7c6b99729260b7e8)


---

### Задание 2

`Установите Node Exporter`


При необходимости прикрепитe сюда скриншоты
[Скрин exporete](https://ru.paste.pics/f41cbc3b172899591b651e8b63138205)


---

### Задание 3

`Подключите Node Exporter к серверу Prometheus` 

[Название скриншота](ссылка на скриншот)
[Скриншот что мой шаблон привязан к двух хостам iszheltov-1 и iszheltov-2](https://ru.paste.pics/0e05077b061cc9ea4d06e42557705e0c)
[Скрин 1](https://ru.paste.pics/cb5edb4f1bf3fe3da847fcc89fc0d331)
[Скрин 2](https://ru.paste.pics/6b7f0c330b3874d2a65e00b3a3a90edc)


### Задание 4

`Установите Grafana`

При необходимости прикрепитe сюда скриншоты
[скрин garafana](https://ru.paste.pics/42b8fd8ec9f8e9f1c60235d13ab91967)



### Задание 5

`Интегрируйте Grafana и Prometheu`

При необходимости прикрепитe сюда скриншоты
[Интеграция](https://ru.paste.pics/df36ddc79b1a814a82ac8a3c05a94e13)




# Домашнее задание к занятию "`Система мониторинга Prometheus часть 2`" - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---

### Задание 1

`Создайте файл с правилом оповещения, как в лекции, и добавьте его в конфиг Prometheus`


При необходимости прикрепитe сюда скриншоты
[статус pending](https://ru.paste.pics/850aa0961ea8c17723d2e2f0737db7fb)


---

### Задание 2

`Установите Alertmanager и интегрируйте его с Prometheus`


При необходимости прикрепитe сюда скриншоты
[Скрин Fireing](https://ru.paste.pics/d007049a44c71bc8aefb751b47ba79ae)
[Правило оповещения](https://ru.paste.pics/6ec02dcafa957ac2ce6a9e24d76fa5ac)


---

### Задание 3

`Активируйте экспортёр метрик в Docker и подключите его к Prometheus` 

[Название скриншота](ссылка на скриншот)
[endpoint](https://ru.paste.pics/2d4ac0bc28a839ab8da35c47a38ab0e0)
[prom](https://ru.paste.pics/0b11f60d3ee5527e966bb4ae9048b8a4)


### Задание 4

`Установите Grafana`

При необходимости прикрепитe сюда скриншоты
[скрин garafana docker](https://ru.paste.pics/fa659988ec1bae284569de85cc95a452)










# Домашнее задание к занятию "`Disaster recovery и Keepalived`" - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---


### Задание 1

`Дана схема для Cisco Packet Tracer, рассматриваемая в лекции.`
`На данной схеме уже настроено отслеживание интерфейсов маршрутизаторов Gi0/1 (для нулевой группы)`
`Необходимо аналогично настроить отслеживание состояния интерфейсов Gi0/0 (для первой группы).`
`Для проверки корректности настройки, разорвите один из кабелей между одним из маршрутизаторов и Switch0 и запустите ping между PC0 и Server0.`
`На проверку отправьте получившуюся схему в формате pkt и скриншот, где виден процесс настройки маршрутизатора.`

1. `С помощью команды sho standby можно увидеться выполненые настройки`
2. `При разрве любого соединения пакет дайдет в нужном напарвлении`


При необходимости прикрепитe сюда скриншоты
[скрин конфигурвции](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/dz1.png)
[схема](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/dz1.pkt)


### Задание 2

`Запустите две виртуальные машины Linux, установите и настройте сервис Keepalived как в лекции, используя пример конфигурационного файла.`
`Настройте любой веб-сервер (например, nginx или simple python server) на двух виртуальных машинах`
`Напишите Bash-скрипт, который будет проверять доступность порта данного веб-сервера и существование файла index.html в root-директории данного веб-сервера.`
`Настройте Keepalived так, чтобы он запускал данный скрипт каждые 3 секунды и переносил виртуальный IP на другой сервер, если bash-скрипт завершался с кодом, отличным от нуля (то есть порт веб-сервера был недоступен или отсутствовал index.html). Используйте для этого секцию vrrp_script`
`На проверку отправьте получившейся bash-скрипт и конфигурационный файл keepalived, а также скриншот с демонстрацией переезда плавающего ip на другой сервер в случае недоступности порта или файла index.html`

1. `Поднял две машины на Debian и настроил Keepalived`
2. `Поднял два сервира nginx на каждой машине`
3. `Скрипт реализован на Bash`
4. `Настроил итервал в 3 секунды что было ip перемещался на другую ноду в случа недоступности`

[скрин запущенныйх служб keepalived](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/1k.png)
[скрин запущенныйх служб keepalived](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/2k.png)
[nginx1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/1n.png)
[nginx2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/2n.png)
[настройка keepalived1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/master.png)
[настройка keepalived2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/back.png)
[скрипт](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/script.png)
[Демонстрация работы 1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/1-1.png)
[продолжение скрипта](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/1-2.png)


# Домашнее задание к занятию "`Домашнее задание к занятию 2 «Кластеризация и балансировка нагрузки»`" - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---


### Задание 1

Запустите два `simple python` сервера на своей виртуальной машине на разных портах
Установите и настройте HAProxy, воспользуйтесь материалами к лекции по ссылке
Настройте балансировку `Round-robin` на 4 уровне
На проверку направьте конфигурационный файл haproxy, скриншоты, где видно перенаправление запросов на разные серверы при обращении к `HAProxy`.

1. Запускаю ВМ и создаю две директории
 ```bash
mkdir http1
``` 
```bash
mkdir http2
``` 

2. Установил haproxy
 ```bash 
sudo apt-get install haproxy
```

3. Установил haproxy
 Запустил два python-сервера с разными портами. Один с портом 8888
 ![Запуска сервер 1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/sr1.png)

 Запустил два python-сервера с разными портами. Один с портом 9999
 ![Запуск сервера 2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/sr2.png)


4. Из материалов к лекции выполнил настройку конфигурационного файла для балансировки на L4
```bash
global
        log /dev/log    local0
        log /dev/log    local1 notice
        chroot /var/lib/haproxy
        stats socket /run/haproxy/admin.sock mode 660 level admin
        stats timeout 30s
        user haproxy
        group haproxy
        daemon

        # Default SSL material locations
        ca-base /etc/ssl/certs
        crt-base /etc/ssl/private

        # See: https://ssl-config.mozilla.org/#server=haproxy&server-version=2.0.3&config=intermediate
        ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RS>
        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
        ssl-default-bind-options ssl-min-ver TLSv1.2 no-tls-tickets

defaults
        log     global
        mode    http
        option  httplog
        option  dontlognull
        timeout connect 5000
        timeout client  50000
        timeout server  50000
        errorfile 400 /etc/haproxy/errors/400.http
        errorfile 403 /etc/haproxy/errors/403.http
        errorfile 408 /etc/haproxy/errors/408.http
        errorfile 500 /etc/haproxy/errors/500.http
        errorfile 502 /etc/haproxy/errors/502.http
        errorfile 503 /etc/haproxy/errors/503.http
        errorfile 504 /etc/haproxy/errors/504.http

listen stats
        bind                    :888
        mode                    http
        stats                   enable
        stats uri               /stats
        stats refresh           5s
        stats realm             Haproxy\ Statistics

frontend example
        mode http
        bind :8088
        default_backend web_servers

backend web_servers
        mode http
        balance roundrobin
        option httpchk
        http-check send meth GET uri /index.html
        server s1 127.0.0.1:8888 check
        server s2 127.0.0.1:9999 check

listen web_tcp

        bind :1325

        server s1 127.0.0.1:8888 check inter 3s
        server s2 127.0.0.1:9999 check inter 3s

```

5. Проверил в браузере страницу со статистикой .

![Стата](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/stat.png)

### Задание 2

Запустите три `simple python` сервера на своей виртуальной машине на разных портах
Настройте балансировку `Weighted Round Robin` на 7 уровне, чтобы первый сервер имел вес 2, второй - 3, а третий - 4
HAproxy должен балансировать только тот `http-трафик`, который адресован домену example.local
На проверку направьте конфигурационный файл haproxy, скриншоты, где видно перенаправление запросов на разные серверы при обращении к HAProxy c использованием домена `example.local` и без него.


1. Я добавил 3-ю диркторию `http3`, в ней  создал файл `index.html` вот с такими данными `Server 3 :6666` и запустил в ней Python-server
2. Открываю  конфигурационный файл `haproxy`
--
```bash
sudo nano /etc/haproxy/haproxy.cfg
```
--
и в пунктах `forntend` и `backend` изменил следующие настройки

![Скрин изменений](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/zdz.png)
--

перезагружаем `HaProxy`
И попробуем отправить запрос домену `example.com`

```bash
curl -H 'Host:example.local' http://127.0.0.1:8088
```
![Чекаем по домену](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/zapros.png)

и получаю балансировку по весу серверов: 
- 4 запроса на 888
- 3 запроса на 666
- 2 запроса на 999

![Скрин запросов](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/final.png)
--

Если сделать запрос без указания хоста , то мы получим ошибку

![Скрин](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/error.png)
--

Файл конфигурации
[Файл конфигурации](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/haproxy.cfg)




# Домашнее задание к занятию `Домашнее задание к занятию 3 Резервное копирование` - `Zheltov Ilya`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

----

### Задание 1
Составьте команду `rsync`, которая позволяет создавать зеркальную копию домашней директории пользователя в директорию `/tmp/backup`
Необходимо исключить из синхронизации все директории, начинающиеся с точки (скрытые)
Необходимо сделать так, чтобы `rsync` подсчитывал хэш-суммы для всех файлов, даже если их время модификации и размер идентичны в источнике и приемнике.
На проверку направить скриншот с командой и результатом ее выполнения

1. Прилагаю скриншот своей команды 
---
 ![Команда rsync](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/rsync.png)

- `a` Архивный режим (сохраняет права, символьные ссылки и временные метки)
- `c` Заставляет rsync использовать контрольные суммы (хэши) для проверки файлов
- `progress` Наблюдаем за прогрессом выполнения
- `exlude` Исключаем файлы которые не сенхронизируются
- `delete` копирование в режиме заркалирования
---
![Выполнение команды](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/rsync_done.png)
 Убрал `--progress` что бы наглядно показать
---

### Задание 2

Написать скрипт и настроить задачу на регулярное резервное копирование домашней директории пользователя с помощью `rsync` и `cron`.
Резервная копия должна быть полностью зеркальной
Резервная копия должна создаваться раз в день, в системном логе должна появляться запись об успешном или неуспешном выполнении операции
Резервная копия размещается локально, в директории `/tmp/backup`
На проверку направить файл `crontab` и скриншот с результатом работы утилиты.


1. Написал скрипт на bash который.
```bash
#!/bin/bash

SOURCE="/home/iszheltov/"
DEST="/tmp/backup_iszheltov/"
LOG_TAG="backup_iszheltov"

# Создаём директорию назначения, но сначала проверим существует или нет
if [ ! -d "$DEST" ]; then
    mkdir -p "$DEST"
fi


rsync -av --delete "$SOURCE" "$DEST"

if [ $? -eq 0 ]; then
    logger -t "$LOG_TAG" "Backup успешно выполнен для $SOURCE в $DEST"
else
    logger -t "$LOG_TAG" "Ошибка при выполнении backup для $SOURCE"
    exit 1
fi
```
---
- Делае зеркалированное резервное копирование
- Добавил задачу в cron для ежедневного выполнения
- Добавил лог фаил который все это логирует
- Копия складывается локально в `/tmp/backup_iszheltov`
---
![Crontab -L](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/cron.png)

Для проверки работы дерним скрипт вручную

![result](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/result.png)

Для наглядности выполнения отключил `verbous`e в скрипте.

### Задание 3

Настройте ограничение на используемую пропускную способность `rsync` до 1 Мбит/c
Проверьте настройку, синхронизируя большой файл между двумя серверами
На проверку направьте команду и результат ее выполнения в виде скриншота

Для ограниче на пропускную способность нужно использовать `bwlimit`
Расчитаем сначала более точно что бы выставить ограничения
`1 Мбит/с = 1024 Кбит/с = 1024 / 8 КБ/с ≈ 128 КБ/с`. Для точности и меньшего потребления возьмем 125 КБ/с

![bwlimit](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/bwlimite.png)
---
![2-й сервер](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/server2.png)
---
Как мы видим скорость передачи была не выше 125.




# Домашнее задание к «Базы данных, их типы» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!


### Задание 1

Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.
Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?
1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.
1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?
1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.
1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?
1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.
1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?
1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.
1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?
1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

### Ответы

1.1 Для этой задачи важно обеспечить целостность и чёткую структуру данных, так как финансовые данные должны быть надёжными, консистентными и легко доступны для аналитики. Скорее всего лучше  будет реляционная база данных, например, PostgreSQL или Oracle.

1.1.* Для ускорения хеширования можно использовать более эффективные алгоритмы или библиотеки, например, xxHash. Еще можно попробовать с помощью аппаратного решения например GPU

1.2 Тут я думаю что лучше использовать NoSQL БД например MongoDB. Даст высокую скорость работы с неструктурированными данными и легко будет интегрироваться с web приложениями.

1.2* Думаю что да, для таких целей может подойти PostgreSQL, он поддерживате реляционные так JSON данные.

1.3 Тут простая структура, подойдет MySQL или то же самый PostgreSQL. Их быстро настроить для простой структуры данных.

1.3* Да, PostgreSQL. Это решение позволяет объединить данные в рамках одной базы, что упростит поддержку и интеграцию или вообще можно срздать отдельнуюь схему.

1.4 думаю что тут нужно использовать БД Графов.

1.4* Думаю что можно. Если же данные закупок сильно отличаются и не требуют связей с логистикой, то лучше создать отдельную реалиционную БД.

1.5 Да можно это PostgreSQL. Но все же пометка, например задачи  логистики с графовой структурой могут быть решены намного эффективней используя самые подходящие решения.

### Задание 2

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

### Ответы

2.1 
1. Инициация транзакции пользователем
2. Проверка валидности данных
3. Запрос на авторизацию платежа
4. Авторизация и резервирование средств
5. Обработка транзакции
6. Завершение Транзакции

2.1*

1. Настройка автоплатежа
2. Проверка условий автоплатежа
3. Запрос на авторизацию платежа
4. Авторизация и резервирование средств
5. Обработка транзакции
6. Завершение Транзакции
(тут не уверен но так в моей голове)

### Задание 3

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.

3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

3.1
1.Поддержка транзакций и гарантия целостности данных (ACID):
2.Чёткая структура данных
3.Стандартный язык запросов
4.Поддержка сложных запросов и аналитики
5.Широкая поддержка и зрелость технологий

3.2

1.Горизонтальная масштабируемость
2.Поддержка транзакций
3.Высокая производительность
4.Совместимость с SQL
(только 4 пока я выделил)


### Задание 4

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин.
На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?

Тяжело мне на него ответить.
Я бы выбирал по кретериям таким

1.Масштабируемость
2.Поддержка распределённых вычислений
3.Тип данных и операции
4.Требования к целостности данных
4.Тип рабочих нагрузок

Голова очень сильно закипела пришлось почитать кучу информации и и почитать про модели распределения 

1. Apache Hadoop
2. Apache Spark
3. NewSQL системы

Не буду их описывать поскольку обьем большой информации не усваиваеться так быстро.

К такому итогу я пришел
Если ваши данные требуют сложных транзакционных операций с высокой целостностью и частыми запросами, и они структурированы, то подойдут NewSQL решения.
Если основная задача – это масштабируемая аналитическая обработка больших данных, то оптимальным будет использование Apache Spark вместе с NoSQL хранилищем.


# Домашнее задание к «Кеширование Redis/memcached» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!


### Задание 1

Кеширование
Приведите примеры проблем, которые может решить кеширование.

### Ответ
Как говорилось в лекции кешироваие может решить такие проблемы как 
Повышение производительности
Увеличение скорости ответа
Экономия ресурсов
Сглаживание бустов трафика

### Задание 2
Memcached
Установите и запустите memcached.

1. Для установки `memcached` использовал `docker` и сразу запусти в контейнере
2. Использовал команду 
```bash
docker run --name mem-test2 -p 11211:11211 -d memcached 
```
3. Сразу скачал послдению версию пробросил порт что бы подключиться через `telnet` по порту `11211`
4. ![doker_and_memcached](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/doker_and_memcached.png)

### Задание 3

Удаление по TTL в Memcached
Запишите в memcached несколько ключей с любыми именами и значениями, для которых выставлен TTL 5.

1. Тут просто приложу скрин на результат работы.

![ttl_adn5sec](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/ttl_adn5sec.png)

#### Задание 4

Запишите в Redis несколько ключей с любыми именами и значениями.

Через redis-cli достаньте все записанные ключи и значения из базы, приведите скриншот этой операции.

1. Для установки `redis` использовал `docker` и сразу запусти в контейнере
2. Использовал команду
```bash
docker run --name redis-t -d redis 
```
3. Порт пробрасывать не обязательно поскольку будет подключаться к контейнеру и управлять от туда команда 
```bash
docker exec -it redis-t redis-cli 
```
4. ![keys_redis](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/keys_redis.png)

#### Задание 5

Запишите в Redis ключ key5 со значением типа "int" равным числу 5. Увеличьте его на 5, чтобы в итоге в значении лежало число 10.

Приведите скриншот, где будут проделаны все операции и будет видно, что значение key5 стало равно 10.

1. Тут будет просто скрин 

![incrybt_redis](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/incrybt_redis.png)

# Домашнее задание к «ELK» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1
Установите и запустите Elasticsearch, после чего поменяйте параметр cluster_name на случайный.
Приведите скриншот команды 'curl -X GET 'localhost:9200/_cluster/health?pretty', сделанной на сервере с установленным Elasticsearch. Где будет виден нестандартный cluster_name.

#### Ответ

1. Я установил docker compose
```bash
sudo curl -L "https://github.com/docker/compose/releases/download/2.23.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
```
2. Начал писать `docker-compose.yml` и первым делом добавил туда установку `Elasticsearch`
```bash
version: '3.8'

services:
  elasticsearch:
    image: elasticsearch:8.12.2
    environment:
      - discovery.type=single-node
      - cluster.name=iszheltov
      - xpack.security.enabled=false
    ports:
      - "9200:9200"
      - "9300:9300"
    volumes:
      - esdata:/usr/share/elasticsearch/data

```
3. Далее запустил `docker-compose up -d`

4. [docker_run](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/docker_run.png)

5. [curl_GET](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/curl_GET.png)


#### Задание 2
Установите и запустите Kibana.
Приведите скриншот интерфейса Kibana на странице http://<ip вашего сервера>:5601/app/dev_tools#/console, где будет выполнен запрос GET /_cluster/health?pretty.

#### Ответ

1. Дополнил свой `docker-compose.yml` и добавил туда установку Kibana 
```bash
kibana:
    image: kibana:8.12.2
    ports:
      - "5601:5601"
    depends_on:
      - elasticsearch
    environment:
      - ELASTICSEARCH_HOSTS=http://elasticsearch:9200 
```

2. Далее запустил `docker-compose up -d`

4. [docker_run_kibana](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/docker_run_kibana.png)

5. [http_kibana](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/http_kibana.png)

#### Задание 3

Установите и запустите Logstash и Nginx. С помощью Logstash отправьте access-лог Nginx в Elasticsearch.
Приведите скриншот интерфейса Kibana, на котором видны логи Nginx.

#### Ответ

1. Дополнил свой `docker-compose.yml` и добавил туда установку Logstah и Nginx.
```bash
logstash:
    image: logstash:8.12.2
    environment:
      - ELASTICSEARCH_HOST=elasticsearch
    volumes:
      - ./logs:/var/log/nginx
      - ./logstash.conf:/usr/share/logstash/pipeline/logstash.conf
    ports:
      - "5044:5044"

  nginx:
    image: nginx:latest
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./logs:/var/log/nginx
    ports:
      - "80:80"                  
```

2. Далее запустил `docker-compose up -d`

4. [docker_run_kibana_log_nginx](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/docker_run_kibana_log_nginx.png)

5. [inteface_kibana_nginx](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/inteface_kibana_nginx.png)

6. [inte](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/inte.png)

#### Задание 4

Установите и запустите Filebeat. Переключите поставку логов Nginx с Logstash на Filebeat.
Приведите скриншот интерфейса Kibana, на котором видны логи Nginx, которые были отправлены через Filebeat.

1. Дополнил свой `docker-compose.yml` и добавил туда установку filebeat.
```bash
filebeat:
    image: elastic/filebeat:8.12.2
    volumes:
      - ./filebeat.yml:/usr/share/filebeat/filebeat.yml
      - ./logs:/var/log/nginx
    depends_on:
      - elasticsearch
    command: filebeat -e -strict.perms=false
```
2. Далее запустил `docker-compose up -d`

3. [docker_run_kibana_log_nginx_filebeat](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/docker_run_kibana_log_nginx_filebeat.png)

4. [filebeat_log1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/filebeat_log1.png)

5. [filebeat_log2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/filebeat_log2.png)

Так же прикладываю свой `yml` файл [file_yaml](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/version3.yaml)

# Домашнее задание к «RebbitMQ» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1
Используя Vagrant или VirtualBox, создайте виртуальную машину и установите RabbitMQ. Добавьте management plug-in и зайдите в веб-интерфейс.

#### Ответ
[web_rebbit1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/web_rebbit1.png)

#### Задание 2
Используя приложенные скрипты, проведите тестовую отправку и получение сообщения. Для отправки сообщений необходимо запустить скрипт producer.py.
Для работы скриптов вам необходимо установить Python версии 3 и библиотеку Pika. Также в скриптах нужно указать IP-адрес машины, на которой запущен RabbitMQ, заменив localhost на нужный IP.
$ pip install pika
Зайдите в веб-интерфейс, найдите очередь под названием hello и сделайте скриншот. После чего запустите второй скрипт consumer.py и сделайте скриншот результата выполнения скрипта
В качестве решения домашнего задания приложите оба скриншота, сделанных на этапе выполнения.
Для закрепления материала можете попробовать модифицировать скрипты, чтобы поменять название очереди и отправляемое сообщение.

### Ответ

[zr1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/zr1.png)

Так же мы видм запуск самого скрипта
[zr2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/zr2.png)


#### Задание 3
Используя Vagrant или VirtualBox, создайте вторую виртуальную машину и установите RabbitMQ. Добавьте в файл hosts название и IP-адрес каждой машины, чтобы машины могли видеть друг друга по имени.
Пример содержимого hosts файла:
$ cat /etc/hosts
192.168.0.10 rmq01
192.168.0.11 rmq02
После этого ваши машины могут пинговаться по имени.
Затем объедините две машины в кластер и создайте политику ha-all на все очереди.
В качестве решения домашнего задания приложите скриншоты из веб-интерфейса с информацией о доступных нодах в кластере и включённой политикой.
Также приложите вывод команды с двух нод:
$ rabbitmqctl cluster_status
Для закрепления материала снова запустите скрипт producer.py и приложите скриншот выполнения команды на каждой из нод:
$ rabbitmqadmin get queue='hello'
После чего попробуйте отключить одну из нод, желательно ту, к которой подключались из скрипта, затем поправьте параметры подключения в скрипте consumer.py на вторую ноду и запустите его.
Приложите скриншот результата работы второго скрипта.

#### Ответ
Политику создаем командой:

`rabbitmqctl set_policy ha-all ""  '{"ha-mode":"all","ha-sync-mode":"automatic"}'`

Так же не забываем проверять что `cat /var/lib/rabbitmq/.erlang.cookie` одинаковые на каждой машине

В кластер объединяем командами:
`rabbitmqctl stop_app`
`rabbitmqctl join_cluster {ip_addr or dns name another rbmq server}`
`rabbitmqctl start_app`
`rabbitmqctl cluster_status`

Скришот где видно что в кластере 2 ноды
[cl](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/cl.png)

Видно что установлена политика
[cl1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/cl2.png)

Вывод команды `rabbitmqctl cluster_status`rmq1
[rmq1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/rmq1.png)

Вывод команды `rabbitmqctl cluster_status`rmq2
[rmq2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/rmq2.png)

Вывод команды `$ rabbitmqadmin get queue='hello'` на rmq1
[get1](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/get1.png)

Вывод команды `$ rabbitmqadmin get queue='hello'` на rmq2
[get2](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/get2.png)

[fin](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/fin.png)

# Домашнее задание к «Базы данных» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1

Легенда
Заказчик передал вам файл в формате Excel, в котором сформирован отчёт.
На основе этого отчёта нужно выполнить следующие задания.

Задание 1
Опишите не менее семи таблиц, из которых состоит база данных:
какие данные хранятся в этих таблицах;
какой тип данных у столбцов в этих таблицах, если данные хранятся в PostgreSQL.
Приведите решение к следующему виду:
Сотрудники (

идентификатор, первичный ключ, serial,
фамилия varchar(50),
...
идентификатор структурного подразделения, внешний ключ, integer).

#### Ответ 1
Как то получилось так, очень пока тяжеловато с ходу правильно разбить.

1. Сотрудники (Employees)

идентификатор (primary key, serial) — уникальный идентификатор сотрудника.

ФИО (full_name, varchar(100)) — фамилия, имя и отчество сотрудника.

оклад (salary, numeric(10, 2)) — заработная плата сотрудника.

должность (position, varchar(100)) — название должности сотрудника.

идентификатор подразделения (department_id, integer) — внешний ключ на таблицу "Подразделения".

дата найма (hire_date, date) — дата найма сотрудника.

идентификатор проекта (project_id, integer) — внешний ключ на таблицу "Проекты".

2. Подразделения (Departments)

идентификатор (primary key, serial) — уникальный идентификатор подразделения.

название подразделения (department_name, varchar(100)) — название подразделения.

тип подразделения (department_type, varchar(50)) — тип подразделения (группа, отдел).

3. Проекты (Projects)

идентификатор (primary key, serial) — уникальный идентификатор проекта.

название проекта (project_name, varchar(100)) — наименование проекта.

описание проекта (project_description, text) — краткое описание проекта 

4. Филиалы (Branches)

идентификатор (primary key, serial) — уникальный идентификатор филиала.

адрес филиала (branch_address, varchar(255)) — физический адрес филиала.

город (city, varchar(100)) — город, в котором находится филиал.

регион (region, varchar(100)) — регион, где расположен филиал.

5. Должности (Positions)

идентификатор (primary key, serial) — уникальный идентификатор должности.

название должности (position_name, varchar(100)) — наименование должности (например, ведущий инженер).

оклад (salary, numeric(10, 2)) — базовый оклад для должности.

6. Типы подразделений (Department_Types)

идентификатор (primary key, serial) — уникальный идентификатор типа подразделения.

название типа (type_name, varchar(50)) — тип подразделения (например, "отдел", "группа").

7. Назначения на проекты (Project_Assignments)

идентификатор (primary key, serial) — уникальный идентификатор записи о назначении.

идентификатор сотрудника (employee_id, integer) — внешний ключ на таблицу "Сотрудники".

идентификатор проекта (project_id, integer) — внешний ключ на таблицу "Проекты".



# Домашнее задание к «Работа с данными (DDL/DML)» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1

1.1. Поднимите чистый инстанс MySQL версии 8.0+. Можно использовать локальный сервер или контейнер Docker.

1.2. Создайте учётную запись sys_temp.

1.3. Выполните запрос на получение списка пользователей в базе данных. (скриншот)

1.4. Дайте все права для пользователя sys_temp.

1.5. Выполните запрос на получение списка прав для пользователя sys_temp. (скриншот)

1.6. Переподключитесь к базе данных от имени sys_temp.

Для смены типа аутентификации с sha2 используйте запрос:
```bash
 ALTER USER 'sys_test'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password';                 
```
1.7. По ссылке https://downloads.mysql.com/docs/sakila-db.zip скачайте дамп базы данных.

1.8. Восстановите дамп в базу данных.

1.9. При работе в IDE сформируйте ER-диаграмму получившейся базы данных. При работе в командной строке используйте команду для получения всех таблиц базы данных. (скриншот)

Результатом работы должны быть скриншоты обозначенных заданий, а также простыня со всеми запросами.

### Ответ

1.1. Устанавдивает MySql 8+ версии
 
 Обновляем нашу систему 
```bash
 sudo apt update && sudo apt upgrade -y                
```
 Далее 
 ````bash
 wget https://dev.mysql.com/get/mysql-apt-config_0.8.22-1_all.deb
 ````
можно и последнию версию но я остановился на этой.

 Добавляем репозитории 
 ````bash 
 sudo dpkg -i mysql-apt-config_0.8.22-1_all.deb
 ````
 Далее добавляем GPG ключи 
 ````bash 
 wget -qO - https://repo.mysql.com/RPM-GPG-KEY-mysql-2023 | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/mysql.gpg`
 ````
 Примечание: Для разной версии используются разные ключи просьба проверять.

 Потом мы делаем 
 ````bash
 sudo apt update
 ````
 Установка 
 ````bash
 sudo apt install mysql-server
 ````
 Добавляем в автозагрузку 
 ````bash
 sudo systemctl enable mysql
 ````
 Установка завершена.

1.2
 Для создание учетной записи пользователя sys_temp использую команду
```bash
 CREATE USER 'sys_temp'@'localhost' IDENTIFIED BY 'PASSWORD';                 
```
1.3
 Для получения списка пользователей используем команду
```bash
 SELECT User, Host FROM mysql.user;;                 
```
[select_user](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/select_user.png)

1.4
 Для выдачи всех прав для sys_temp используем команду
```bash
 GRANT ALL PRIVILEGES ON *.* TO 'sys_temp'@'localhost' WITH GRANT OPTION;                 
```
1.5 
 Что бы выполнеть запрос на получение всех прав для пользователя sys_temp нужно сделать команду
```bash
SHOW GRANTS FOR 'sys_temp'@'localhost';                 
```
1.6
 Перезаходим используя команду 
 ````bash
 mysql -u sys_temp -p
 ````

1.7
 Скачал.

1.8
 Создаеи базу `sakila` с помощью команды 
 ````bash
 CREATE DATABASE sakila;
 ````
 Далее нам нужно восстановить структуру БД 
 ````bash
 mysql -u sys_temp -p sakila < /path/to/your/sakila-schema.sql
 ````
 После это восстановление данных из файла 
 ````bash
 mysql -u root -p sakila < /path/to/your/sakila-data.sql
 ````

1.9
Дигармма
[diagram](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/diagram.png)

Запрос вывод все тбалиц через консоль
Перед этим 
````bash
use sakila;
````
Команда 
````bash
SHOW TABLES;
````
[show_tables](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/show_tables.png)

#### Задание 2

Составьте таблицу, используя любой текстовый редактор или Excel, в которой должно быть два столбца: в первом должны быть 
названия таблиц восстановленной базы, во втором названия первичных ключей этих таблиц. Пример: (скриншот/текст)

### Ответ

Я решил попрбовать написать запрос и пожалел. Лучше бы просто переписал, но вроде как получилось.
```bash
SELECT 
    kcu.TABLE_NAME AS table_name,
    kcu.COLUMN_NAME AS primary_key_column
FROM 
    INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS tc
JOIN 
    INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS kcu
    ON tc.CONSTRAINT_NAME = kcu.CONSTRAINT_NAME
    AND tc.TABLE_SCHEMA = kcu.TABLE_SCHEMA
    AND tc.TABLE_NAME = kcu.TABLE_NAME
WHERE 
    tc.CONSTRAINT_TYPE = 'PRIMARY KEY'
    AND tc.TABLE_SCHEMA = 'sakila'
    AND tc.TABLE_NAME IN ('actor', 'address', 'category', 'city', 'country', 'customer', 'film', 'film_actor', 'film_category', 'film_text', 'inventory', 'language', 'payment', 'rental', 'staff', 'store')
ORDER BY 
    kcu.TABLE_NAME, kcu.ORDINAL_POSITION;                 
```
Скрин выполнения команды
[key](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/key.png)

#### Задание 3

3.1. Уберите у пользователя sys_temp права на внесение, изменение и удаление данных из базы sakila.

3.2. Выполните запрос на получение списка прав для пользователя sys_temp. (скриншот)

Результатом работы должны быть скриншоты обозначенных заданий, а также простыня со всеми запросами.

### Ответ

3.1
Что бы убрать все права во всех БД нужно использоват команду.
```bash
REVOKE ALL PRIVILEGES ON *. * FROM 'sys_temp'@'localhost';;                 
```

3.2 Делаем запрос и проверяем права командой
```bash
SHOW GRANTS FOR 'sys_temp'@'localhost';                 
```
Команда вывести все права.

[grants](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/grants.png)


# Домашнее задание к «Индексы» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1

Напишите запрос к учебной базе данных, который вернёт процентное отношение общего размера всех индексов к общему размеру всех таблиц.

#### Ответ

Мой запрос который выводит общий размер всех индексов к общему размеру
```bash
SELECT 
    (SUM(INDEX_LENGTH) / NULLIF(SUM(DATA_LENGTH), 0) * 100) AS index_to_table_size_ratio
FROM 
    information_schema.tables
WHERE 
    TABLE_SCHEMA = 'sakila';
```
[index_proc](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/index_proc.png)

#### Задание 2

Выполните explain analyze следующего запроса:
```bash
select distinct concat(c.last_name, ' ', c.first_name), sum(p.amount) over (partition by c.customer_id, f.title)
from payment p, rental r, customer c, inventory i, film f
where date(p.payment_date) = '2005-07-30' and p.payment_date = r.rental_date and r.customer_id = c.customer_id and i.inventory_id = r.inventory_id;
```
перечислите узкие места;
оптимизируйте запрос: внесите корректировки по использованию операторов, при необходимости добавьте индексы.

#### Ответ

1. Для начала сделал анализ данного запроса и что я заметил

1.1 Убрал из запроса таблицы film, inventory
1.2 Добавил index payment_date
1.3 Поменял условие для использования индекса.
1.4 Так же можно переделать еще на JOIN но я запутался и у меня стали разниться значения оставил как есть.

```bash
select distinct  concat(c.last_name, ' ', c.first_name ), sum(p.amount) over (partition by c.customer_id )
from payment p, rental r, customer c
where p.payment_date >= '2005-07-30 00:00:00' AND p.payment_date < '2005-07-30 23:59:59'  and p.payment_date = r.rental_date and r.customer_id = c.customer_id
```

[optimization_zapros](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/optimization_zapros.png)



# Домашнее задание к «SQL. Часть 1» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1

Получите уникальные названия районов из таблицы с адресами, которые начинаются на “K” и заканчиваются на “a” и не содержат пробелов.

#### Ответ

```bash
SELECT DISTINCT district 
FROM address
WHERE district LIKE 'K%a' 
  AND district NOT LIKE '% %';
```
[addres_unik](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/addres_unik.png)

#### Задание 2

Получите из таблицы платежей за прокат фильмов информацию по платежам, которые выполнялись в промежуток с 15 июня 2005 года по 18 июня 2005 года включительно и стоимость которых превышает 10.00.

#### Ответ

```bash
SELECT *
FROM payment
WHERE payment_date >= '2005-06-15' 
  AND payment_date <= '2005-06-18 23:59:59'
  AND amount > 10.00;
```

[platez_procat](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/platez_procat.png)

#### Задание 3

Получите последние пять аренд фильмов.

#### Ответ
```bash
SELECT *
FROM payment
WHERE payment_date >= '2005-06-15' 
  AND payment_date <= '2005-06-18 23:59:59'
  AND amount > 10.00;
```
[arenda_film](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/arenda_film.png)

#### Задание 4
Одним запросом получите активных покупателей, имена которых Kelly или Willie.

Сформируйте вывод в результат таким образом:

все буквы в фамилии и имени из верхнего регистра переведите в нижний регистр,
замените буквы 'll' в именах на 'pp'.

#### Ответ

```bash
SELECT LOWER (last_name) AS last_name, LOWER (first_name) AS first_name, REPLACE (LOWER (first_name), 'll', 'pp') AS replaced_first_name
FROM customer
WHERE first_name = 'Kelly' OR first_name = 'Willie' AND active = 1;
```
[activ_pokup](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/activ_pokup.png)



# Домашнее задание к «SQL. Часть 2» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1

Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей и выведите в результат следующую информацию:

фамилия и имя сотрудника из этого магазина,
город нахождения магазина,
количество пользователей, закрепленных в этом магазине.

#### Ответ

```bash
SELECT concat(s.first_name  , ' ', s.last_name) as Имя , c.city,  count(c2.customer_id) as Количество 
FROM staff s 
JOIN address a  ON s.address_id = a.address_id 
JOIN city c  ON a.city_id = c.city_id 
JOIN store s2 ON s2.store_id = s.store_id 
JOIN customer c2 ON s2.store_id = c2.store_id 
GROUP BY s.first_name , s.last_name , c.city 
HAVING Количество > 300;
```
[300_p](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/300_p.png)

#### Задание 2

Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

#### Ответ

```bash
SELECT  count(`length`) 
FROM film 
WHERE `length` > (SELECT avg(`length`)FROM film )
```

[film](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/film.png)

#### Задание 3

Получите информацию, за какой месяц была получена наибольшая сумма платежей и добавьте информацию по количеству аренд за этот месяц.

#### Ответ
```bash
SELECT DATE_FORMAT(p.payment_date, '%Y-%M') AS Дата , (sum(p.amount )) AS Сумма , count((p.rental_id )) AS Аренд
FROM payment p 
GROUP BY Дата
ORDER BY Сумма DESC
LIMIT 1;
```
[summ](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/summ.png)



# Домашнее задание к «Уязвимости и атаки на информационные системы» - Zheltov Ilya

1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!

#### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
*Приведите ответ в свободной форме.* 

#### Ответ 1

<details>

С помощью вот такой команды мы получим все необходимое 
```bash
nmap -sS -sV -O -p- 192.168.193.2 
```

![nmap](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/nmap.png)

Также было найдено много уязвимости, ссылки на описание которых сразу же выдается при сканировании. Вот некоторые из них:
- vsftpd 2.3.4 - https://vulners.com/exploitdb/EDB-ID:49757
- Samba 3.x Remote Code Execution - https://vulners.com/seebug/SSV:60292;
- Apache Tomcat Manager Application Default Credentials -   https://vulners.com/cve/CVE-2022-2795.


</details>

#### Задания 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
Как отвечает сервер?
Приведите ответ в свободной форме.

<details>

*Режим SYN -sS*
При использовании данного режима Nmap посылает SYN пакет и для хоста это выглядит как будто с ним хотят установить реальное соединение. Если приходит ответ SYN/ACK – значит порт открыт, а если RST – значит закрыт, если ответ не приходит или пришло ICMP-сообщение об ошибке – значит порт фильтруется.

[nmapSYN](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/nmapSYN.png)

*Режим FIN -sF*

Вместо SYN-пакета, Nmap начинает FIN-исследование, используя FIN-пакет. Поскольку ранее соединение с исследуемым узлом не было установлено, исследуемый узел отвечает RST-пакетом для сброса соединения. Поступая таким образом, исследуемый узел сообщает о своем существовании. 

[nmapFIN](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/nmapFIN.png)

*Режим Xmas -sX*

В этом случае TCP-пакеты отсылаются с установленными флагами PSH, URG и FIN. Этот тип также ожидает пакеты RST для closed портов.  Отправленный пакет не содержит биты SYN, RST или ACK и и в ответ будет отправка RST в случае, если порт закрыт, или не повлечет никакого ответа, если порт открыт. При Xmas устанавливаются FIN, PSH и URG флаги. Если в ответ приходит RST пакет, то порт считается закрытым, отсутствие ответа означает, что порт открыт|фильтруется.

[nmapXmas](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/nmapXmas.png)

*Режим UDP -sU*

Данный вид позволяет сканировать порты используемые UDP службами и работает путём отправки пустого UDP заголовка на соответствующие порты. Если приходит ошибка “порт недостижим”, то в зависимости от типа ошибки Nmap определяет – порт закрыт или фильтруется, если в ответ пришел UDP – пакет значит порт открыт, а если ответа нет – будет присвоен статус open|filtered. Работает UDP сканирование крайне медленно и для ускорения процесса рекомендуется задать список интересующих портов (например -p U:53).

[nmapUDP](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/nmapUDP.png)

</details>



# Домашнее задание к занятию  «Защита хоста-ZheltovIS»

### Инструкция по выполнению домашнего задания

1. Сделайте fork [репозитория c шаблоном решения](https://github.com/netology-code/sys-pattern-homework) к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/gitlab-hw или https://github.com/имя-вашего-репозитория/8-03-hw).
2. Выполните клонирование этого репозитория к себе на ПК с помощью команды `git clone`.
3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
   - впишите вверху название занятия и ваши фамилию и имя;
   - в каждом задании добавьте решение в требуемом виде: текст/код/скриншоты/ссылка;
   - для корректного добавления скриншотов воспользуйтесь инструкцией [«Как вставить скриншот в шаблон с решением»](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md);
   - при оформлении используйте возможности языка разметки md. Коротко об этом можно посмотреть в [инструкции по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md).
4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`).
5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
6. Любые вопросы задавайте в чате учебной группы и/или в разделе «Вопросы по заданию» в личном кабинете.

Желаем успехов в выполнении домашнего задания.

------

### Задание 1

1. Установите **eCryptfs**.
2. Добавьте пользователя cryptouser.
3. Зашифруйте домашний каталог пользователя с помощью eCryptfs.


*В качестве ответа  пришлите снимки экрана домашнего каталога пользователя с исходными и зашифрованными данными.* 

### Ответ 1
Обновляем и устаналиваем 
```bash
sudo apt update
sudo apt install ecryptfs-utils
```

Для добавления нового пользователя используйте команду adduser:
```bash
sudo adduser cryptouser
```
Далее установим lsof
```bash
sudo apt install lsof
```
Запустил модуль 
```bash
sudo modprobe ecryptfs
```

Ишифруем домашнию директорию этого юхера
```bash
sudo ecryptfs-migrate-home -u cryptouser
```
[shifr](https://github.com/ilyajeltov/sys-pattern-homework/tree/main/img/shifr.png)

### Задание 2

1. Установите поддержку **LUKS**.
2. Создайте небольшой раздел, например, 100 Мб.
3. Зашифруйте созданный раздел с помощью LUKS.

*В качестве ответа пришлите снимки экрана с поэтапным выполнением задания.*

### Ответ 2

Устанавливаем gparted cryptsetup (LUKS)
```bash
apt install gparted cryptsetup
```

В esxi добавляем доп. диск размер (100 МБ)
```bash
echo "- - -" | tee /sys/class/scsi_host/host*/scan
```

проверяем
```bash
fdisk -l
Disk /dev/sdb: 100 MiB, 104857600 bytes, 204800 sectors
Disk model: Virtual disk
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
```

подготавливаем раздел
```bash
cryptsetup -y -v --type luks2 luksFormat /dev/sdb
```
Вывод
```bash
cryptsetup -y -v --type luks2 luksFormat /dev/sdb

WARNING: Device /dev/sdb already contains a 'ext4' superblock signature.

WARNING!
========
This will overwrite data on /dev/sdb irrevocably.

Are you sure? (Type 'yes' in capital letters): YES
Enter passphrase for /dev/sdb:
Verify passphrase:
Existing 'ext4' superblock signature on device /dev/sdb will be wiped.

Key slot 0 created.
Command successful.
```
Открываем устройство /dev/sdb и задаем ему имя cryptodisk
```bash
sudo cryptsetup luksOpen /dev/sdb cryptodisk
```

Проверяем

```bash
ls -al /dev/mapper/cryptodisk
lrwxrwxrwx 1 root root 7 Jun 27 20:53 /dev/mapper/cryptodisk -> ../dm-1
```

Форматируем раздел

```bash
sudo dd if=/dev/zero of=/dev/mapper/cryptodisk
sudo mkfs.ext4 /dev/mapper/cryptodisk
```

вывод
```bash
sudo dd if=/dev/zero of=/dev/mapper/cryptodisk
dd: writing to '/dev/mapper/cryptodisk': No space left on device
172033+0 records in
172032+0 records out
88080384 bytes (88 MB, 84 MiB) copied, 1.76524 s, 49.9 MB/s
root@ubuntu22-client:~# sudo mkfs.ext4 /dev/mapper/cryptodisk
mke2fs 1.46.5 (30-Dec-2021)
Creating filesystem with 21504 4k blocks and 21504 inodes

Allocating group tables: done
Writing inode tables: done
Creating journal (1024 blocks): done
Writing superblocks and filesystem accounting information: done
```
Монитируем открытый раздел
```bash
mkdir .secret
sudo mount /dev/mapper/cryptodisk .secret/
```

конец
```bash
sudo umount .secret
sudo cryptsetup luksClose cryptodisk
```








